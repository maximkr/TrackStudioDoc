<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../helpproject.xsl" ?>
<topic template="Default" lasteditedby="Administrator" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title translate="true">How to Save the History of Changes in Task Parameters</title>
  <body>
    <header>
      <para styleclass="Heading1"><text styleclass="Heading1" translate="true">How to Save the History of Changes in Task Parameters</text></para>
    </header>
    <para styleclass="Normal" style="text-indent:48px; background-color:#ffffff;"><text styleclass="Normal" style="font-family:Verdana; font-size:12pt; vertical-align:baseline; color:#000000;" translate="true">Starting with version</text><text styleclass="apple-converted-space" style="font-family:Verdana; font-size:12pt; font-weight:normal; font-style:normal; text-decoration:none; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;" translate="true">&#32;</text><text styleclass="Normal" style="font-family:Verdana; font-size:12pt; font-weight:bold; vertical-align:baseline; color:#000000;" translate="true">4.0.9</text><text styleclass="apple-converted-space" style="font-family:Verdana; font-size:12pt; font-weight:bold; font-style:normal; text-decoration:none; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;" translate="true">&#32;</text><text styleclass="Normal" style="font-family:Verdana; font-size:12pt; vertical-align:baseline; color:#000000;" translate="true">,TrackStudio now has an in-built mechanism for auditing the changes. So as to enable it, you just need to create an operation with the name</text><text styleclass="Normal" style="font-family:Verdana; font-size:12pt; font-weight:bold; vertical-align:baseline; color:#000000;" translate="true">*</text><text styleclass="apple-converted-space" style="font-family:Verdana; font-size:12pt; font-weight:bold; font-style:normal; text-decoration:none; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;" translate="true">&#32;</text><text styleclass="Normal" style="font-family:Verdana; font-size:12pt; vertical-align:baseline; color:#000000;" translate="true">in the required</text><text styleclass="apple-converted-space" style="font-family:Verdana; font-size:12pt; font-weight:normal; font-style:normal; text-decoration:none; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;" translate="true">&#32;</text><text styleclass="Normal" style="font-family:Verdana; font-size:12pt; font-weight:bold; vertical-align:baseline; color:#000000;" translate="true">process</text><text styleclass="Normal" style="font-family:Verdana; font-size:12pt; vertical-align:baseline; color:#000000;" translate="true">. Thereafter, all the changes, taking place in the task, will be recorded with the help of this operation, though without considering the user permissions (if the user can edit the task, or execute any operation on it – a system message will also be generated). You can set the permissions of viewing this operation, in the same way as for remaining operations.</text></para>
    <para styleclass="Normal" style="text-indent:48px; background-color:#ffffff;"><text styleclass="Normal" style="font-family:Verdana; font-size:12pt; vertical-align:baseline; color:#000000;" translate="true">In TrackStudio from version 4.0 to 4.0.8 this feature is not in-built, but it can be managed using triggers. This solution can be treated simply as an example of using triggers.</text></para>
    <para styleclass="Normal" style="text-indent:48px; background-color:#ffffff;"><text styleclass="Normal" style="font-family:Verdana; font-size:12pt; vertical-align:baseline; color:#000000;" translate="true">Task properties may change when the task itself is edited as well as when some operation is performed. This means that we will require not one but two triggers of different types, working on same principle. As for tracking the changes we must know the state of task</text><text styleclass="apple-converted-space" style="font-family:Verdana; font-size:12pt; font-weight:normal; font-style:normal; text-decoration:none; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;" translate="true">&#32;</text><text styleclass="Normal" style="font-family:Verdana; font-size:12pt; font-weight:bold; vertical-align:baseline; color:#000000;" translate="true">before</text><text styleclass="Normal" style="font-family:Verdana; font-size:12pt; vertical-align:baseline; color:#000000;" translate="true">incorporating these changes, trigger of type</text><text styleclass="apple-converted-space" style="font-family:Verdana; font-size:12pt; font-weight:normal; font-style:normal; text-decoration:none; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;" translate="true">&#32;</text><text styleclass="Normal" style="font-family:Verdana; font-size:12pt; font-weight:bold; vertical-align:baseline; color:#000000;" translate="true">After</text><text styleclass="apple-converted-space" style="font-family:Verdana; font-size:12pt; font-weight:bold; font-style:normal; text-decoration:none; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;" translate="true">&#32;</text><text styleclass="Normal" style="font-family:Verdana; font-size:12pt; vertical-align:baseline; color:#000000;" translate="true">will not work – then the changes have already been recorded. Trigger of type Before will not work for us as the recording about changes takes place before the changes, which, at first place, can once again change the properties of task, and secondly, can return the false information, if the change itself didn’t take place because of error.</text></para>
    <para styleclass="Normal" style="text-indent:48px; background-color:#ffffff;"><text styleclass="Normal" style="font-family:Verdana; font-size:12pt; vertical-align:baseline; color:#000000;" translate="true">Consequently, we require two triggers of type Instead Of.</text></para>
    <para styleclass="Normal" style="text-indent:48px; background-color:#ffffff;"><text styleclass="Normal" style="font-family:Verdana; font-size:12pt; vertical-align:baseline; color:#000000;" translate="true">For editing the task, we will write the trigger Instead Of Edit Task. It must correspond to the interface</text><text styleclass="Normal" style="font-family:Verdana; font-size:12pt; font-weight:bold; vertical-align:baseline; color:#000000;" translate="true">com.trackstudio.external.TaskTrigger</text><text styleclass="apple-converted-space" style="font-family:Verdana; font-size:12pt; font-weight:normal; font-style:normal; text-decoration:none; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;" translate="true">&#32;</text><text styleclass="Normal" style="font-family:Verdana; font-size:12pt; vertical-align:baseline; color:#000000;" translate="true">and stored in the folder</text></para>
    <para styleclass="Code"><text styleclass="Code" translate="true">./etc/plugins/scripts/instead_of_edit_task/</text></para>
    <para styleclass="Code Example"><text styleclass="Code Example" translate="true">package scripts.instead_of_edit_task;</text><br/><text styleclass="Code Example" translate="true">import com.trackstudio.app.adapter.AdapterManager;</text><br/><text styleclass="Code Example" translate="true">import com.trackstudio.app.csv.CSVImport;</text><br/><text styleclass="Code Example" translate="true">import com.trackstudio.exception.GranException;</text><br/><text styleclass="Code Example" translate="true">import com.trackstudio.external.TaskTrigger;</text><br/><text styleclass="Code Example" translate="true">import com.trackstudio.secured.*;</text><br/><text styleclass="Code Example" translate="true">import com.trackstudio.startup.I18n;</text><br/><text styleclass="Code Example" translate="true">import java.util.Calendar;</text><br/><text styleclass="Code Example" translate="true">/**</text><br/><text styleclass="Code Example" translate="true"> * Script saves all the changes of the task</text><br/><text styleclass="Code Example" translate="true"> */</text><br/><text styleclass="Code Example" translate="true">public class LogChanges implements TaskTrigger {</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160;public SecuredTaskTriggerBean execute(SecuredTaskTriggerBean task) throws GranException {</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;StringBuffer sb2 = new StringBuffer();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;StringBuffer sb = new StringBuffer();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;sb2.append(&quot;&lt;table class=\&quot;general\&quot; cellpadding=4&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;String budget = task.getBudgetAsString();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;Calendar deadline = task.getDeadline();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;SecuredPrstatusBean group = task.getHandlerGroup();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;SecuredUserBean user = task.getHandlerUser();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;SecuredPriorityBean priority = task.getPriority();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;SecuredResolutionBean resolution = task.getResolution();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;String description = task.getDescription();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;String name = task.getName();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;String alias = task.getShortname();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;SecuredTaskBean oldTask = new SecuredTaskBean(task.getId(), task.getSecure());</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;String _name = oldTask.getName();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;String _alias = oldTask.getShortname();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;String _budget = oldTask.getBudgetAsString();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;Calendar _deadline = oldTask.getDeadline();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;SecuredPrstatusBean _group = oldTask.getHandlerGroup();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;SecuredUserBean _user = oldTask.getHandlerUser();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;SecuredPriorityBean _priority = oldTask.getPriority();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;SecuredResolutionBean _resolution = oldTask.getResolution();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;String _description = oldTask.getDescription();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;if ((_name != null &amp;&amp; !_name.equals(name)) || (_name == null &amp;&amp; name != null)) {</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;tr&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;th align=\&quot;right\&quot;&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(I18n.getString(task.getSecure(), &quot;NAME&quot;));</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/th&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&lt;strike&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(_name);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/strike&gt;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(name);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/tr&gt;\n&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;}</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;if ((_alias != null &amp;&amp; !_alias.equals(alias)) || (_alias == null &amp;&amp; alias != null)) {</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;tr&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;th align=\&quot;right\&quot;&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(I18n.getString(task.getSecure(), &quot;ALIAS&quot;));</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/th&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&lt;strike&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(_alias);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/strike&gt;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(alias);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/tr&gt;\n&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;}</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;if ((_budget != null &amp;&amp; !_budget.equals(budget)) || (_budget == null &amp;&amp; budget != null)) {</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;tr&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;th align=\&quot;right\&quot;&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(I18n.getString(task.getSecure(), &quot;BUDGET&quot;));</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/th&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&lt;strike&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(_budget);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/strike&gt;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(budget);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/tr&gt;\n&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;}</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;if ((_deadline != null &amp;&amp; !_deadline.equals(deadline)) || (_deadline == null &amp;&amp; deadline != null)) {</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;tr&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;th align=\&quot;right\&quot;&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(I18n.getString(task.getSecure(), &quot;DEADLINE&quot;));</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/th&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&lt;strike&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;if (_deadline != null)</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(task.getSecure().getUser().getDateFormatter().parse(_deadline));</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/strike&gt;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;if (deadline != null)</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(task.getSecure().getUser().getDateFormatter().parse(deadline));</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/tr&gt;\n&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;}</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;if ((_priority != null &amp;&amp; !_priority.equals(priority)) || (_priority == null &amp;&amp; priority != null)) {</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;tr&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;th align=\&quot;right\&quot;&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(I18n.getString(task.getSecure(), &quot;PRIORITY&quot;));</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/th&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&lt;strike&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;if (_priority != null)</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(_priority.getName());</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/strike&gt;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;if (priority != null)</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(priority.getName());</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/tr&gt;\n&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;}</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;if ((_resolution != null &amp;&amp; !_resolution.equals(resolution)) || (_resolution == null &amp;&amp; resolution != null)) {</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;tr&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;th align=\&quot;right\&quot;&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(I18n.getString(task.getSecure(), &quot;RESOLUTION&quot;));</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/th&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&lt;strike&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;if (_resolution != null)</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(_resolution.getName());</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/strike&gt;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;if (resolution != null)</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(resolution.getName());</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/tr&gt;\n&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;}</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;if ((_user != null &amp;&amp; !_user.equals(user)) || (_user == null &amp;&amp; user != null)) {</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;tr&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;th align=\&quot;right\&quot;&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(I18n.getString(task.getSecure(), &quot;HANDLER&quot;));</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/th&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&lt;strike&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;if (_user != null)</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(_user.getName());</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/strike&gt;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;if (user != null)</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(user.getName());</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/tr&gt;\n&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;}</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;if ((_group != null &amp;&amp; !_group.equals(group)) || (_group == null &amp;&amp; group != null)) {</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;tr&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;th align=\&quot;right\&quot;&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(I18n.getString(task.getSecure(), &quot;HANDLER&quot;));</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/th&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&lt;strike&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;if (_group != null)</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(_group.getName());</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/strike&gt;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;if (group != null)</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(group.getName());</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/tr&gt;\n&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;}</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;if ((_description != null &amp;&amp; !_description.equals(description)) || (_description == null &amp;&amp; description != null)) {</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;tr&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;th align=\&quot;right\&quot;&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(I18n.getString(task.getSecure(), &quot;DESCRIPTION&quot;));</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/th&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&lt;strike&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(_description);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/strike&gt;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(description);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/tr&gt;\n&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;}</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;if (task.getUdfValues() != null &amp;&amp; !task.getUdfValues().isEmpty()) {</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;for (Object okey : task.getUdfValues().keySet()) {</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;String key = okey.toString();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;String value = task.getUdfValues().get(key).toString();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;String oldValue = AdapterManager.getInstance().getSecuredUDFAdapterManager()</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;.getTaskUDFValue(task.getSecure(), task.getId(), key);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;if ((oldValue != null &amp;&amp; !oldValue.equals(value))</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|| (oldValue == null &amp;&amp; value != null)) {</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;tr&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;th align=\&quot;right\&quot;&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(key);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/th&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&lt;strike&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(oldValue);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/strike&gt;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(value);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/tr&gt;\n&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;}</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;}</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;}</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;SecuredMessageTriggerBean createMessage = null;</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;if (sb.length() &gt; 0) {</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb2.append(sb);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb2.append(&quot;&lt;/table&gt;\n&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;String mstatusId = CSVImport.findMessageTypeIdByName(&quot;Log&quot;, task.getCategory().getName());</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;/**</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; * Создаем SecuredMessageTriggerBean</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; */</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;createMessage = new SecuredMessageTriggerBean(</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;null /* identifier */,</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb2.toString() /* text of the comment */,</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;Calendar.getInstance() /* time of operation execution */,</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;null /* spent time */,</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;task.getDeadline() /* deadline */,</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;task.getBudget() /* budget */,</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;task.getId() /* task */,</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;task.getSecure().getUserId() /* operation submitter и */,</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;null /* resolution */,</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;task.getPriorityId() /* priority */,</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;task.getHandlerId() /* assignees */,</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;task.getHandlerUserId() /* assignee */,</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;task.getHandlerGroupId() /* assignee, if group is to be set as assignee */,</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;mstatusId /* type of operation */,</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;null /* Map with custom fields */,</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;task.getSecure() /* SessionContext */,</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;null /* attachments */);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;/**</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; * execute &#160; &#160; &#160; &#160; &#160; &#160; */</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;}</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;task.update(true);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;if (createMessage != null) createMessage.create(false);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;return task;</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160;}</text><br/><text styleclass="Code Example" translate="true">}</text></para>
    <para styleclass="Normal" style="text-indent:48px; background-color:#ffffff;"><text styleclass="Normal" style="font-family:Verdana; font-size:12pt; font-weight:bold; vertical-align:baseline; color:#000000;" translate="true">This trigger must be included in the category settings of those tasks, changes in which are to be tracked</text><text styleclass="apple-converted-space" style="font-family:Verdana; font-size:12pt; font-weight:bold; font-style:normal; text-decoration:none; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;" translate="true">&#32;</text><text styleclass="Normal" style="font-family:Verdana; font-size:12pt; vertical-align:baseline; color:#000000;" translate="true">. Thus in the processes of tasks, there must be the operation “</text><text styleclass="Normal" style="font-family:Verdana; font-size:12pt; font-weight:bold; vertical-align:baseline; color:#000000;" translate="true">Log</text><text styleclass="Normal" style="font-family:Verdana; font-size:12pt; vertical-align:baseline; color:#000000;" translate="true">”, which does not change the state of task. Name of the operation can be, of course, changed. In that case, do not forget to change it in both the triggers.</text></para>
    <para styleclass="Normal" style="text-indent:48px; background-color:#ffffff;"><text styleclass="Normal" style="font-family:Verdana; font-size:12pt; vertical-align:baseline; color:#000000;" translate="true">Further, for tracking the changes in the tasks, carried out with the help of operations (add notes/messages), we will require the trigger Instead Of Add Message. It must correspond to the interface</text></para>
    <para styleclass="Normal" style="text-indent:48px; background-color:#ffffff;"><text styleclass="Normal" style="font-family:Verdana; font-size:12pt; font-weight:bold; vertical-align:baseline; color:#000000;" translate="true">com.trackstudio.external.OperationTrigger</text><text styleclass="apple-converted-space" style="font-family:Verdana; font-size:12pt; font-weight:normal; font-style:normal; text-decoration:none; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;" translate="true">&#32;</text><text styleclass="Normal" style="font-family:Verdana; font-size:12pt; vertical-align:baseline; color:#000000;" translate="true">and stored in the folder</text></para>
    <para styleclass="Code"><text styleclass="Code" translate="true">./etc/plugins/scripts/instead_of_add_message/</text></para>
    <para styleclass="Code Example"><text styleclass="Code Example" translate="true">package scripts.instead_of_add_message;</text><br/><text styleclass="Code Example" translate="true">import com.trackstudio.app.adapter.AdapterManager;</text><br/><text styleclass="Code Example" translate="true">import com.trackstudio.app.csv.CSVImport;</text><br/><text styleclass="Code Example" translate="true">import com.trackstudio.exception.GranException;</text><br/><text styleclass="Code Example" translate="true">import com.trackstudio.external.OperationTrigger;</text><br/><text styleclass="Code Example" translate="true">import com.trackstudio.secured.*;</text><br/><text styleclass="Code Example" translate="true">import com.trackstudio.startup.I18n;</text><br/><text styleclass="Code Example" translate="true">import java.util.Calendar;</text><br/><text styleclass="Code Example" translate="true">public class LogChanges implements OperationTrigger {</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160;public SecuredMessageTriggerBean execute(SecuredMessageTriggerBean message) throws GranException {</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;StringBuffer sb2 = new StringBuffer();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;StringBuffer sb = new StringBuffer();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;sb2.append(&quot;&lt;table class=\&quot;general\&quot; cellpadding=4&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;String budget = message.getBudgetAsString();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;Calendar deadline = message.getDeadline();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;SecuredPrstatusBean group = message.getHandlerGroup();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;SecuredUserBean user = message.getHandlerUser();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;SecuredPriorityBean priority = message.getPriority();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;SecuredResolutionBean resolution = message.getResolution();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;SecuredStatusBean state = message.getTask().getStatus();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;String _budget = message.getTask().getBudgetAsString();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;Calendar _deadline = message.getTask().getDeadline();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;SecuredPrstatusBean _group = message.getTask().getHandlerGroup();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;SecuredUserBean _user = message.getTask().getHandlerUser();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;SecuredPriorityBean _priority = message.getTask().getPriority();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;SecuredResolutionBean _resolution = message.getTask().getResolution();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;SecuredStatusBean _state = null;</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;for (SecuredTransitionBean t : message.getMstatus().getTransitions()) {</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;if (t.getStart().equals(state)) _state = t.getFinish();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;break;</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;}</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;if ((_budget != null &amp;&amp; !_budget.equals(budget)) || (_budget == null &amp;&amp; budget != null)) {</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;tr&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;th align=\&quot;right\&quot;&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(I18n.getString(message.getSecure(), &quot;BUDGET&quot;));</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/th&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&lt;strike&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(_budget);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/strike&gt;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(budget);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/tr&gt;\n&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;}</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;if ((_deadline != null &amp;&amp; !_deadline.equals(deadline)) || (_deadline == null &amp;&amp; deadline != null)) {</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;tr&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;th align=\&quot;right\&quot;&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(I18n.getString(message.getSecure(), &quot;DEADLINE&quot;));</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/th&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&lt;strike&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;if (_deadline != null)</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(message.getSecure().getUser().getDateFormatter().parse(_deadline));</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/strike&gt;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;if (deadline != null)</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(message.getSecure().getUser().getDateFormatter().parse(deadline));</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/tr&gt;\n&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;}</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;if ((_priority != null &amp;&amp; !_priority.equals(priority)) || (_priority == null &amp;&amp; priority != null)) {</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;tr&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;th align=\&quot;right\&quot;&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(I18n.getString(message.getSecure(), &quot;PRIORITY&quot;));</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/th&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&lt;strike&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;if (_priority != null)</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(_priority.getName());</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/strike&gt;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;if (priority != null)</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(priority.getName());</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/tr&gt;\n&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;}</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;if ((_resolution != null &amp;&amp; !_resolution.equals(resolution)) || (_resolution == null &amp;&amp; resolution != null)) {</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;tr&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;th align=\&quot;right\&quot;&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(I18n.getString(message.getSecure(), &quot;RESOLUTION&quot;));</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/th&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&lt;strike&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;if (_resolution != null)</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(_resolution.getName());</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/strike&gt;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;if (resolution != null)</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(resolution.getName());</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/tr&gt;\n&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;}</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;if ((_user != null &amp;&amp; !_user.equals(user)) || (_user == null &amp;&amp; user != null)) {</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;tr&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;th align=\&quot;right\&quot;&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(I18n.getString(message.getSecure(), &quot;HANDLER&quot;));</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/th&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&lt;strike&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;if (_user != null)</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(_user.getName());</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/strike&gt;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;if (user != null)</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(user.getName());</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/tr&gt;\n&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;}</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;if ((_group != null &amp;&amp; !_group.equals(group)) || (_group == null &amp;&amp; group != null)) {</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;tr&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;th align=\&quot;right\&quot;&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(I18n.getString(message.getSecure(), &quot;HANDLER&quot;));</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/th&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&lt;strike&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;if (_group != null)</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(_group.getName());</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/strike&gt;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;if (group != null)</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(group.getName());</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/tr&gt;\n&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;}</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;if ((_state != null &amp;&amp; !_state.equals(state)) || (_state == null &amp;&amp; state != null)) {</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;tr&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;th align=\&quot;right\&quot;&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(I18n.getString(message.getSecure(), &quot;TASK_STATE&quot;));</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/th&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&lt;strike&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(_state.getName());</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/strike&gt;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(state.getName());</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/tr&gt;\n&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;}</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;if (message.getUdfValues() != null &amp;&amp; !message.getUdfValues().isEmpty()) {</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;for (Object okey : message.getUdfValues().keySet()) {</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;String key = okey.toString();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;String value = message.getUdfValues().get(key).toString();</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;String oldValue = AdapterManager.getInstance().getSecuredUDFAdapterManager()</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;.getTaskUDFValue(message.getSecure(), message.getTaskId(), key);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;if ((oldValue != null &amp;&amp; !oldValue.equals(value))</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|| (oldValue == null &amp;&amp; value != null)) {</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;tr&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;th align=\&quot;right\&quot;&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(key);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/th&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&lt;strike&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(oldValue);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/strike&gt;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(value);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/td&gt;&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb.append(&quot;&lt;/tr&gt;\n&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;}</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;}</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;}</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;SecuredMessageTriggerBean createMessage = null;</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;if (sb.length() &gt; 0) {</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb2.append(sb);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;sb2.append(&quot;&lt;/table&gt;\n&quot;);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;String mstatusId = CSVImport.findMessageTypeIdByName(&quot;Log&quot;, message.getTask().getCategory().getName());</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;/**</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; * Создаем SecuredMessageTriggerBean</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; */</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;createMessage = new SecuredMessageTriggerBean(</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;null /* identifier */,</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sb2.toString() /* text of the comment */,</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;Calendar.getInstance() /* time of execution of operation */,</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;null /* spent time */,</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;message.getDeadline() /* deadlines */,</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;message.getBudget() /* budget */,</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;message.getTaskId() /* task */,</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;message.getSecure().getUserId() /* submitter of operation */,</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;null /* resolution */,</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;message.getPriorityId() /* priority */,</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;message.getHandlerId() /* assignees */,</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;message.getHandlerUserId() /* assignee */,</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;message.getHandlerGroupId() /* assignee, if group is to be set as assignee */,</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;mstatusId /* type of operation */,</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;null /* Map with custom fields */,</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;message.getSecure() /* SessionContext */,</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;null /* attachments */);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160;/**</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160; &#160; &#160; * execute &#160; &#160; &#160; &#160; &#160; &#160; */</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;}</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;message.create(true);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;if (createMessage != null) createMessage.create(false);</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160; &#160; &#160;return message;</text><br/><text styleclass="Code Example" translate="true"> &#160; &#160;}</text><br/><text styleclass="Code Example" translate="true">}</text></para>
    <para styleclass="Normal" style="text-indent:48px; background-color:#ffffff;"><text styleclass="Normal" style="font-family:Verdana; font-size:12pt; font-weight:bold; vertical-align:baseline; color:#000000;" translate="true">This trigger must be attached in the parameters of those operations, which you want to track</text><text styleclass="Normal" style="font-family:Verdana; font-size:12pt; vertical-align:baseline; color:#000000;" translate="true">. Thus in the process of tasks, there must be the operation “</text><text styleclass="Normal" style="font-family:Verdana; font-size:12pt; font-weight:bold; vertical-align:baseline; color:#000000;" translate="true">Log</text><text styleclass="Normal" style="font-family:Verdana; font-size:12pt; vertical-align:baseline; color:#000000;" translate="true">”, which does not change the state of task.</text><text styleclass="apple-converted-space" style="font-family:Verdana; font-size:12pt; font-weight:normal; font-style:normal; text-decoration:none; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;" translate="true">&#32;</text><text styleclass="Normal" style="font-family:Verdana; font-size:12pt; font-weight:bold; vertical-align:baseline; color:#000000;" translate="true">Do not connect the trigger to the operation “Log”. Refer</text><text styleclass="apple-converted-space" style="font-family:Verdana; font-size:12pt; font-weight:bold; font-style:normal; text-decoration:none; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;" translate="true">&#32;</text><link displaytype="text" defaultstyle="true" type="weblink" href="http://en.wikipedia.org/wiki/Recursion_%28computer_science%29" styleclass="ext" style="font-family:Verdana; font-size:12pt; font-weight:bold; font-style:normal; text-decoration:underline; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;" translate="true">&quot;Recursion&quot;</link><link displaytype="text" defaultstyle="true" type="weblink" href="http://en.wikipedia.org/wiki/Recursion_%28computer_science%29" styleclass="apple-converted-space" style="font-family:Verdana; font-size:12pt; font-weight:bold; font-style:normal; text-decoration:underline; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;" translate="true"> </link><text styleclass="Normal" style="font-family:Verdana; font-size:12pt; vertical-align:baseline; color:#000000;" translate="true">. Name of the operation can be, of course, changed. In that case, do not forget to change it in both the triggers.</text></para>
    <para styleclass="Normal" style="text-indent:48px; background-color:#ffffff; page-break-before:always;"></para>
  </body>
</topic>
